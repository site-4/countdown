<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Countdown</title>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Special+Elite&family=Pacifico&family=Bungee+Shade&family=Press+Start+2P&family=Permanent+Marker&family=Monoton&family=Righteous&display=swap" rel="stylesheet">
    
    <!-- Confetti Library -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>

    <style>
        :root { --m-x: 0; --m-y: 0; --theme-color: #fff; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { height: 100vh; background: #000; display: flex; flex-direction: column; justify-content: center; align-items: center; overflow: hidden; perspective: 1000px; }
        #bg-canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; cursor: crosshair; }
        
        #countdown-container {
            text-align: center; padding: 40px; pointer-events: none; position: relative; z-index: 10;
            transform: rotateY(calc(var(--m-x) * 12deg)) rotateX(calc(var(--m-y) * -12deg));
            transition: transform 0.1s ease-out;
            display: flex; flex-direction: column; align-items: center;
        }

        .timer-display { font-size: 6rem; display: flex; gap: 20px; font-weight: bold; color: var(--theme-color); }
        .unit-box { display: flex; flex-direction: column; align-items: center; }
        .label { font-size: 0.8rem; text-transform: uppercase; letter-spacing: 4px; margin-top: 10px; opacity: 0.7; }

        .subtitle {
            margin-top: 30px;
            font-size: 1.2rem;
            color: var(--theme-color);
            letter-spacing: 3px;
            text-transform: uppercase;
            opacity: 0.9;
            transition: all 0.5s ease;
        }

        /* Font Mappings */
        .f-0, .f-4, .f-7, .f-11, .f-12, .f-14, .f-16, .f-17 { font-family: 'Orbitron'; }
        .f-1, .f-15 { font-family: 'Special Elite'; }
        .f-2 { font-family: 'Pacifico'; }
        .f-3 { font-family: 'Bungee Shade'; }
        .f-5, .f-10 { font-family: 'Righteous'; }
        .f-6 { font-family: 'Press Start 2P'; }
        .f-8, .f-13 { font-family: 'Permanent Marker'; }
        .f-9 { font-family: 'Monoton'; }

        @media (max-width: 768px) { 
            .timer-display { font-size: 2.5rem; gap: 10px; } 
            .subtitle { font-size: 0.8rem; letter-spacing: 1px; }
        }
    </style>
</head>
<body>
    <canvas id="bg-canvas"></canvas>

    <div id="countdown-container">
        <div class="timer-display" id="display-font-box">
            <div class="unit-box"><span id="days">00</span><div class="label">Days</div></div>
            <span>:</span>
            <div class="unit-box"><span id="hours">00</span><div class="label">Hrs</div></div>
            <span>:</span>
            <div class="unit-box"><span id="minutes">00</span><div class="label">Min</div></div>
            <span>:</span>
            <div class="unit-box"><span id="seconds">00</span><div class="label">Sec</div></div>
        </div>
        <div class="subtitle" id="subtitle-box">Something unforgettable unlocks at zero</div>
    </div>

    <script>
        const targetDate = new Date('January 21, 2026 11:32:00').getTime();
        const root = document.documentElement;
        const canvas = document.getElementById('bg-canvas');
        const ctx = canvas.getContext('2d');
        
        let particles = [], manualIdx = -1, currentTheme = -1;
        let mouse = { x: 0, y: 0, rx: 0, ry: 0, down: false };
        let isComplete = false;

        class Part {
            constructor() { this.init(); }
            init() {
                this.x = Math.random() * canvas.width; this.y = Math.random() * canvas.height;
                this.vx = (Math.random()-0.5)*2; this.vy = (Math.random()-0.5)*2;
                this.s = Math.random()*3+1; this.z = Math.random()*canvas.width;
            }
        }

        function setup() {
            canvas.width = window.innerWidth; canvas.height = window.innerHeight;
            particles = []; 
            let count = (currentTheme === 12 || currentTheme === 11) ? 100 : 150;
            if([0,7,5,16].includes(currentTheme)) count = 350;
            for(let i=0; i<count; i++) particles.push(new Part());
        }

        function draw() {
            ctx.clearRect(0,0,canvas.width, canvas.height);
            let b = mouse.down ? 4 : 1;
            const time = Date.now() * 0.001;

            switch(currentTheme) {
                case 17: ctx.fillStyle = '#000'; ctx.fillRect(0,0,canvas.width,canvas.height); particles.forEach(p => { p.y += p.s*2; if(p.y > canvas.height) p.y=0; ctx.fillStyle='#39ff14'; ctx.fillRect(p.x, p.y, 2, 10); }); break;              
                case 16: ctx.fillStyle = '#000'; ctx.fillRect(0,0,canvas.width,canvas.height); particles.forEach(p => { p.z -= 20*b; if(p.z<=0) p.z=canvas.width; let sx = (p.x-canvas.width/2)*(canvas.width/p.z)+canvas.width/2; let sy = (p.y-canvas.height/2)*(canvas.width/p.z)+canvas.height/2; ctx.strokeStyle='#fff6'; ctx.beginPath(); ctx.moveTo(sx,sy); ctx.lineTo(sx*1.1, sy*1.1); ctx.stroke(); }); break;
                case 15: ctx.fillStyle = '#111'; ctx.fillRect(0,0,canvas.width,canvas.height); for(let i=0; i<20; i++) { ctx.strokeStyle = '#333'; ctx.beginPath(); ctx.arc(canvas.width/2+mouse.rx*0.1, canvas.height/2+mouse.ry*0.1, i*40 + (mouse.down?10:0), 0, 7); ctx.stroke(); } break;
                case 14: ctx.fillStyle = '#210101'; ctx.fillRect(0,0,canvas.width,canvas.height); particles.forEach(p => { p.y -= p.s*b; if(p.y<0) {p.y=canvas.height; p.x=Math.random()*canvas.width;} ctx.fillStyle=`hsl(${p.s*10}, 100%, 50%)`; ctx.fillRect(p.x, p.y, p.s, p.s); }); break;
                case 13: ctx.fillStyle = '#041a04'; ctx.fillRect(0,0,canvas.width,canvas.height); particles.forEach(p => { p.y -= 0.5; if(p.y<0) p.y=canvas.height; ctx.fillStyle='#4caf50aa'; ctx.beginPath(); ctx.moveTo(p.x,p.y); ctx.lineTo(p.x+5,p.y+10); ctx.lineTo(p.x-5,p.y+10); ctx.fill(); }); break;
                case 12: ctx.fillStyle='#3e2723'; ctx.fillRect(0,0,canvas.width,canvas.height); particles.forEach(p => { p.y += p.s; if(p.y>canvas.height) p.y=0; ctx.fillStyle='#f5f5dc22'; ctx.fillRect(p.x,p.y,40,50); }); break;
                case 11: ctx.fillStyle = '#020508'; ctx.fillRect(0,0,canvas.width,canvas.height); particles.forEach(p => { p.x += p.vx; p.y += p.vy; if(p.x < 0 || p.x > canvas.width) p.vx *= -1; if(p.y < 0 || p.y > canvas.height) p.vy *= -1; let d = Math.hypot(mouse.rx - p.x, mouse.ry - p.y); if(d < 250) { ctx.strokeStyle = `rgba(0, 255, 255, ${1 - d/250})`; ctx.beginPath(); ctx.moveTo(p.x, p.y); ctx.lineTo(mouse.rx, mouse.ry); ctx.stroke(); } ctx.fillStyle = '#0ff'; ctx.beginPath(); ctx.arc(p.x, p.y, 2, 0, 7); ctx.fill(); }); break;
                case 10: ctx.fillStyle = '#001d3d'; ctx.fillRect(0,0,canvas.width,canvas.height); particles.forEach(p => { p.y -= p.s; if(p.y<0) p.y=canvas.height; ctx.strokeStyle='#0ff5'; ctx.beginPath(); ctx.arc(p.x, p.y, p.s*5, 0, 7); ctx.stroke(); }); break;
                case 9: ctx.fillStyle = '#111'; ctx.fillRect(0,0,canvas.width,canvas.height); ctx.strokeStyle = '#d4af37'; for(let i=0; i<10; i++) { ctx.strokeRect(canvas.width/2 - i*50, canvas.height/2 - i*30, i*100, i*60); } break;
                case 8: if(mouse.down) { ctx.fillStyle=`hsl(${time*100}, 100%, 50%)`; ctx.beginPath(); ctx.arc(mouse.rx, mouse.ry, 20, 0, 7); ctx.fill(); } break;
                case 7: ctx.fillStyle = '#000'; ctx.fillRect(0,0,canvas.width,canvas.height); particles.forEach(p => { p.z -= 15*b; if(p.z<=0) p.z=canvas.width; let sx = (p.x-canvas.width/2)*(canvas.width/p.z)+canvas.width/2; let sy = (p.y-canvas.height/2)*(canvas.width/p.z)+canvas.height/2; ctx.fillStyle='#fff'; ctx.fillRect(sx,sy,2,2); }); break;
                case 6: let id = ctx.createImageData(100,100); for(let i=0; i<id.data.length; i+=4) { id.data[i]=id.data[i+1]=id.data[i+2]=Math.random()*255; id.data[i+3]=50; } ctx.putImageData(id, mouse.rx%100, mouse.ry%100); break;
                case 5: ctx.fillStyle='#000'; ctx.fillRect(0,0,canvas.width,canvas.height); ctx.filter='blur(40px)'; for(let i=0; i<5; i++) { ctx.fillStyle=['#0f9','#0ff','#00f'][i%3]; ctx.beginPath(); ctx.ellipse(canvas.width/2, canvas.height/2 + Math.sin(time+i)*100, canvas.width, 100, Math.sin(time/2), 0, 7); ctx.fill(); } ctx.filter='none'; break;
                case 4: ctx.fillStyle='#000'; ctx.fillRect(0,0,canvas.width,canvas.height); if(Math.random()>0.9) { ctx.fillStyle='#f0f2'; ctx.fillRect(Math.random()*canvas.width, 0, 50, canvas.height); } break;
                case 3: ctx.fillStyle='#2e7d32'; ctx.fillRect(0,0,canvas.width,canvas.height); particles.forEach(p => { p.x += p.vx; p.y += p.vy; if(p.x<0||p.x>canvas.width) p.vx*=-1; ctx.fillStyle='#ccff00'; ctx.beginPath(); ctx.arc(p.x,p.y,2,0,7); ctx.fill(); }); break;
                case 2: ctx.fillStyle='#ff80ab'; ctx.fillRect(0,0,canvas.width,canvas.height); particles.forEach(p => { p.y -= p.s*b; if(p.y<0) p.y=canvas.height; ctx.fillStyle='#fff8'; ctx.font="30px serif"; ctx.fillText("♥", p.x, p.y); }); break;
                case 1: ctx.fillStyle='#000'; ctx.fillRect(0,0,canvas.width,canvas.height); ctx.fillStyle='#0F0'; ctx.font="15px monospace"; particles.forEach(p => { ctx.fillText(Math.floor(Math.random()*2), p.x, p.y); p.y += 15; if(p.y>canvas.height) p.y=0; }); break;
                default: 
                    ctx.fillStyle = '#000'; ctx.fillRect(0,0,canvas.width,canvas.height); 
                    particles.forEach(p => { 
                        p.z -= 1*b; if(p.z<=0) p.z=canvas.width; 
                        let sx = (p.x-canvas.width/2)*(canvas.width/p.z)+canvas.width/2; 
                        let sy = (p.y-canvas.height/2)*(canvas.width/p.z)+canvas.height/2; 
                        ctx.fillStyle=`rgba(255,255,255,${1-p.z/canvas.width})`; 
                        ctx.beginPath(); ctx.arc(sx,sy,1,0,7); ctx.fill(); 
                    });
            }
            requestAnimationFrame(draw);
        }

        function triggerUnlock() {
            if(isComplete) return;
            isComplete = true;
            
            document.getElementById('subtitle-box').innerText = "";
            document.getElementById('subtitle-box').style.color = "#ff0000";
            document.getElementById('subtitle-box').style.textShadow = "0 0 20px #ff0000";

            const heart = confetti.shapeFromText({ text: '❤️', scalar: 3 });
            const duration = 15 * 1000;
            const animationEnd = Date.now() + duration;

            (function frame() {
                const timeLeft = animationEnd - Date.now();
                if (timeLeft <= 0) return;

                // Fire from both sides
                confetti({
                    particleCount: 2,
                    angle: 60,
                    spread: 55,
                    origin: { x: 0, y: 0.6 },
                    colors: ['#ff0000', '#ff69b4', '#ffffff'],
                    shapes: [heart, 'circle'],
                    zIndex: 999
                });
                confetti({
                    particleCount: 2,
                    angle: 120,
                    spread: 55,
                    origin: { x: 1, y: 0.6 },
                    colors: ['#ff0000', '#ff69b4', '#ffffff'],
                    shapes: [heart, 'circle'],
                    zIndex: 999
                });

                // Heavy burst around the center zeroes
                if (Math.random() > 0.8) {
                    confetti({
                        particleCount: 15,
                        spread: 120,
                        origin: { x: 0.5, y: 0.5 },
                        shapes: [heart],
                        colors: ['#ff0000', '#ff0080'],
                        zIndex: 999,
                        scalar: 2
                    });
                }

                requestAnimationFrame(frame);
            }());
        }

        function tick() {
            const diff = targetDate - Date.now();
            const d = Math.max(0, Math.floor(diff/86400000));
            
            if(diff <= 0) triggerUnlock();

            document.getElementById('days').innerText = String(d).padStart(2,'0');
            document.getElementById('hours').innerText = String(Math.max(0,Math.floor((diff%86400000)/3600000))).padStart(2,'0');
            document.getElementById('minutes').innerText = String(Math.max(0,Math.floor((diff%3600000)/60000))).padStart(2,'0');
            document.getElementById('seconds').innerText = String(Math.max(0,Math.floor((diff%60000)/1000))).padStart(2,'0');
            
            let idx = manualIdx!==-1?manualIdx:d; idx=Math.max(0,Math.min(17,idx));
            if(currentTheme!==idx){ 
                currentTheme=idx; setup(); 
                document.getElementById('display-font-box').className = `timer-display f-${idx}`;
                document.getElementById('subtitle-box').className = `subtitle f-${idx}`;
            }
        }
        
        window.addEventListener('mousemove', e => {
            mouse.rx = e.clientX; mouse.ry = e.clientY; mouse.x = (e.clientX/window.innerWidth)*2-1; mouse.y = (e.clientY/window.innerHeight)*2-1;
            root.style.setProperty('--m-x', mouse.x); root.style.setProperty('--m-y', mouse.y);
        });
        window.addEventListener('mousedown', () => mouse.down = true);
        window.addEventListener('mouseup', () => mouse.down = false);
        window.addEventListener('resize', setup);
        
        // TEST KEYS: 
        // - Press 'T' to trigger the unlock celebration immediately.
        // - Press '2' to cycle through all backgrounds manually.
        window.addEventListener('keydown', e => { 
            if(e.key.toLowerCase() === 't') triggerUnlock(); 
            if(e.key === '2'){ manualIdx = (manualIdx >= 17) ? 0 : manualIdx + 1; tick(); }
        });

        setup(); draw(); setInterval(tick, 1000); tick();
    </script>
</body>
</html>
